<div class="gfm"><div class="highlight highlight-source-cs"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Startup</span>
{
    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">Configure</span>(<span class="pl-en">IApplicationBuilder</span> <span class="pl-smi">app</span>, <span class="pl-en">IHostingEnvironment</span> <span class="pl-smi">env</span>, <span class="pl-en">ILoggerFactory</span> <span class="pl-smi">loggerFactory</span>)
    {
        loggerFactory.AddConsole();
        <span class="pl-k">var</span> <span class="pl-en">appSettings </span>= <span class="pl-k">new</span> <span class="pl-en">TextFileSettings</span>(<span class="pl-s"><span class="pl-pds">"</span>~/../../apps/chat/web.settings<span class="pl-pds">"</span></span>.MapProjectPath());
        app.UseServiceStack(<span class="pl-k">new</span> <span class="pl-en">AppHost</span>(<span class="pl-en">appSettings</span>));
    }
}

<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">AppHost</span> : <span class="pl-en">AppHostBase</span>
{
    <span class="pl-k">public</span> <span class="pl-en">AppHost</span>() : <span class="pl-c1">base</span>("Chat Web App", typeof(ServerEventsServices).<span class="pl-en">GetAssembly</span>()) {}
    <span class="pl-k">public</span> <span class="pl-en">AppHost</span>(IAppSettings appSettings) : <span class="pl-c1">this</span>() =&gt; AppSettings = appSettings;

    <span class="pl-k">public</span> <span class="pl-k">override</span> <span class="pl-k">void</span> <span class="pl-en">Configure</span>(<span class="pl-en">Container</span> <span class="pl-smi">container</span>)
    {
        Plugins.AddIfNotExists(<span class="pl-k">new</span> <span class="pl-en">TemplatePagesFeature</span>()); <span class="pl-c">//Already added if it's running as a Web App</span>
        
        Plugins.Add(<span class="pl-k">new</span> <span class="pl-en">ServerEventsFeature</span>());

        SetConfig(<span class="pl-k">new</span> <span class="pl-en">HostConfig</span>
        {
            DefaultContentType = MimeTypes.Json,
            AllowSessionIdsInHttpParams = <span class="pl-c1">true</span>,
        });

        <span class="pl-c1">this</span>.CustomErrorHttpHandlers.Remove(HttpStatusCode.Forbidden);

        <span class="pl-c">//Register all Authentication methods you want to enable for this web app.            </span>
        Plugins.Add(<span class="pl-k">new</span> <span class="pl-en">AuthFeature</span>(
            () =&gt; <span class="pl-k">new</span> <span class="pl-en">AuthUserSession</span>(),
            <span class="pl-k">new</span> <span class="pl-en">IAuthProvider</span>[] {
                <span class="pl-k">new</span> <span class="pl-en">TwitterAuthProvider</span>(<span class="pl-en">AppSettings</span>),   <span class="pl-c">//Sign-in with Twitter</span>
                <span class="pl-k">new</span> <span class="pl-en">FacebookAuthProvider</span>(<span class="pl-en">AppSettings</span>),  <span class="pl-c">//Sign-in with Facebook</span>
                <span class="pl-k">new</span> <span class="pl-en">GithubAuthProvider</span>(<span class="pl-en">AppSettings</span>),    <span class="pl-c">//Sign-in with GitHub</span>
            }));

        container.RegisterAutoWiredAs&lt;MemoryChatHistory, IChatHistory&gt;();

        Plugins.Add(<span class="pl-k">new</span> <span class="pl-en">CorsFeature</span>(
            allowOriginWhitelist: new[] { <span class="pl-s"><span class="pl-pds">"</span>http://localhost<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>http://null.jsbin.com<span class="pl-pds">"</span></span> },
            allowCredentials: <span class="pl-c1">true</span>,
            allowedHeaders: <span class="pl-s"><span class="pl-pds">"</span>Content-Type, Allow, Authorization<span class="pl-pds">"</span></span>));
    }
}</pre></div>
</div>